<!DOCTYPE html>
<html lang="en">
  <head>
  	<meta charset="utf-8">
  	<meta name="viewport"    content="width=device-width, initial-scale=1.0">
  	<meta name="description" content="">
  	<meta name="author"      content="map[]">
    
    	<title>Posts</title>
    
    <script data-ad-client="ca-pub-8444244371421612" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


	<link rel="shortcut icon" href="https://shrinklabs.com/images/favicon.ico">

	
	<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.no-icons.min.css" rel="stylesheet">
	
	
	<script defer src="https://use.fontawesome.com/releases/v5.0.11/js/all.js" integrity="sha384-ImVoB8Er8knetgQakxuBS4G3RSkyD8IZVVQCAnmRJrDwqJFYUE4YOv+DbIofcO9C" crossorigin="anonymous"></script>
	
	
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alice|Open+Sans:400,300,700">
	
	
  
  <link rel="stylesheet" href="https://shrinklabs.com/css/styles.min.64a6643395c6bf1ec6fff31d6429046b3ad467e58a279ff252dc019edd80a87051cf90b7fe2d589277def72d84602dcbc7115e2e17a94db3a8838336986a0ae3.css" integrity="sha512-ZKZkM5XGvx7G//MdZCkEazrUZ&#43;WKJ5/yUtwBnt2AqHBRz5C3/i1Yknfe9y2EYC3LxxFeLhepTbOog4M2mGoK4w==">

   
  

  </head>
  
  <body class="home">

    
      <header id="header">
  <div id="head" class="parallax" data-parallax-speed="2" style="background-image:url('https://shrinklabs.com/images/bg_head.jpg');">
    <h1 id="logo" class="text-center">
      <img class='img-circle' src="https://shrinklabs.com/images/logo.png" alt="">
      <span class="title"></span>
      <span class="tagline"><br>
        <a href="mailto:"></a>
      </span>
   </h1>
</div>

<nav class="navbar navbar-default navbar-sticky">
    <div class="container-fluid">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="true">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1">

            <ul class="nav navbar-nav">
            
                
                <li>
                    <a href="/">home</a>
                </li>
                
            
                
                <li>
                    <a href="/post/">blog</a>
                </li>
                
            
            </ul>

        </div> 
        
    </div>
</nav>

</header>
    
 
    
<main id="main">

	<div class="container">
		<div class="row topspace">
			<div class="col-sm-8 col-sm-offset-2">

        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="January 9, 2019">January 9, 2019</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/container_orchestrating-cloud-with-kubernetes/" rel="bookmark">3.Orchestrating the Cloud With Kubernetes</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>이번 장은 우선 &ldquo;nginx&quot;와 &ldquo;monolith&quot;라는 단어에 현혹되지 않도록 주의를 해야 할 것 같습니다.</p>
<p>최초에 nginx가 실행되는 Pod는 그거대로 Kubnernetes 작동에 대한 내용이고, Pod에 대한 내용에서 언급되는 nginx와 monolith는 또 그것대로의 내용을 설명합니다.</p>
<p>그리고 다음에 나오는 port-forward에 대한 내용은 또 완전히 별개의 내용입니다.</p>
<p>port-forward는 &ldquo;Service&quot;로 노출하지 않는 Pod에 대해서 테스트등을 해보기 위해서 아주 유용한 도구인 것 같습니다.</p>
<p>port-forward로 &ldquo;monolith&rdquo; Pod의 80 포트를 10080을 지정하면 local의 10080 포트를 사용하고 있는것 처럼 이용이 가능합니다.</p>
<p>&ldquo;Service&quot;는 Pod가 수시로 죽고 살아나는 과정 중에서 외부에 노출될 수 있는 일정한 IP를 제공하기 위한 목적입니다.</p>
<p>&ldquo;Service&quot;는 &ldquo;selector&quot;를 이용해서 Pod에 지정된 &ldquo;label&rdquo; 별로 Pod들을 선택할 수 있습니다. 그리고 &ldquo;Service&quot;의 형태로는 &ldquo;ClusterIP&rdquo;, &ldquo;NodePort&rdquo;, &ldquo;LoadBalancer&quot;가 있습니다.</p>
<p>&ldquo;secure-monolith&rdquo; Pod를 생성하는 과정중에 &ldquo;secret&quot;와 &ldquo;configmap&quot;을 생성하는게 나오는데 아직은 크게 신경쓰지 않아도 될 것 같습니다.</p>
<p>둘 다 비슷한 성격을 갖는데, &ldquo;secret&quot;는 패스워드 처럼 민감 데이터를 다루는 성격이고, &ldquo;configmap&quot;은 환경 설정과 같은 성격의 정보를 다룹니다. 특성 또는 상태를 갖는 정보를 포함하지 않고 Pod가 관리될 수 있도록 해줍니다.</p>
<p>&ldquo;Deployment&quot;는 &ldquo;replicas&rdquo; 항목에 지정된 만큼의 Pod를 관리하기 위한 용도입니다.</p>
<p>앞부분에서 약간의 착각을 할 수 있는 부분이 있기는 했었지만 전체적으로 간단하게라도 kubernetes를 이용한 관리방법에 대해서 이해를 할 수 있는 장 이었던것 같습니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="January 8, 2019">January 8, 2019</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/container_hello-node-kubernetes/" rel="bookmark">2.Hello Node Kubernetes</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>2번째 과정에서는 Kubernetes의 기본적인 동작 방식에 대해서 알아 볼 수 있었습니다.</p>
<p>Kubernetes의 클러스터를 생성하는 과정은 Google Cloud Platform에서 기능을 제공하고 있어서 아주 간편했습니다.</p>
<p>책을 보면서 Kubernetes 공부를 처음 시작하는 과정에서 가장 시간을 많이 소비하게 되는 부분이었는데, 플랫폼에서 제공되는 기능을 glcoud를 이용해서 node와 각 node의 기본적인 설정을 지정후 cluster를 생성하는 명령 하나로 모든 과정이 생략될 수 있게 되었습니다.</p>
<p>그리고 Registry Server에 등록해 놓았던 Image를 이용해서 직접 &ldquo;Pod&quot;를 만들어보고, &ldquo;Pod&quot;의 개념과 &ldquo;Deployment&quot;의 개념이 무엇인지에 대해서 대략적으로 알아 볼 수 있었습니다.</p>
<p>다음으로 &ldquo;Service&quot;를 이용하면, 배포된 &ldquo;Pod&quot;들이 어떻게 외부에 노출이 될 수 있는지에 대해서 알아 볼 수 있었습니다.</p>
<p>기존에는 로컬 머신에서 VM들을 생성해서 학습을 하다 보니 외부에 정말 노출이 되는건가? 라는 의문이 들었었는데, &ldquo;LoadBalancer&quot;를 통해서 IP를 할당 받아서 해보니, 제공하고자 하는 기능이 &ldquo;Service&quot;를 통해서 외부에 노출이 될 수 있다는걸 확인 할 수 있었습니다.</p>
<p>서비스의 규모를 조정하기 위해서 scale을 이용해서 Pod를 관리하는걸 확인해 볼 수 있기도 했습니다.</p>
<p>마지막으로 서비스가 업데이트되었을때 배포를 하기 위한 과정에 대해서 알아보면서 Image를 새로 만들고 Registry Server에 재 등록을 하고 Deployment를 수정하는 과정을 실습해볼 수 있었습니다. 과정중에 약간 아쉬웠던 점은 Deployment가 수정되고 난 다음에 기존에 Pod가 종료되고 새로운 버전의 Pod가 활성화 되는 과정에 대해서도 확인을 해보면 과정을 이해하는데 더 좋을것 같았습니다.</p>
<p>(Deployment를 edit하는 과정을 완료하고, 바로 &ldquo;kubectl get pods&quot;를 해보면 확인이 가능합니다.)</p>
<p>추가 사항으로 Kubernetes 대시보드를 보기 위한 방법을 학습하는 부분에서는 해당 url 뒤에 &ldquo;ui&quot;로 변경을 해보았으나 대시보드가 보여지지는 않았습니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="January 8, 2019">January 8, 2019</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/container_introduction-to-docker/" rel="bookmark">1.Introduction to Docker</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>구글에서 지원해주는 “2019 클라우드 스터디잼 입문반” 스터디에 참여하기 시작했습니다.
이 스터디는 어떠한 형태로든 모인 멤버들이 일정 기간(1/7~1/27) 동안에 실습이 겸해진 과정(QWIKLABS - Kubernetes in the Google Cloud)을 완수하는 방식입니다.</p>
<p>첫번째 과정으로 “Introduction to Docker” 을 진행 했습니다. 다음은 과정을 진행하면서 학습할 수 있었던 내용의 요약입니다.</p>
<p>처음 해보는 과정이라서 그런지 익숙해지기 위한 시간이 약간 필요했지만 그다지 어렵지는 않았습니다.</p>
<p>Docker의 Image와 Container 그리고 Dockerfile의 이해를 위한 몇 가지의 실습이 진행되었습니다.
실습들을 통해서 Image와 Container를 어떻게 구분지어서 생각해야 하는지를 학습할 수 있었습니다.</p>
<p>그리고 만들어진 Image는 어떻게 배포하고 관리 되어져야 할 지에 대한 이해를 위해서, 구글에서 서비스하고 있는 플랫폼(Google Cloud Platform)이 제공하는 Registry Server에 gcloud라는 도구을 이용해서 Image를 등록하고 등록된 이미지를 이용하는 실습을 진행되었습니다.</p>
<p>이렇게 해서 첫번째 과정이 완료 되었습니다.</p>
<p>간단한 실습과 설명이었지만 Docker 관련 책에서의 분량으로 가늠해 보면 절반 정도의 내용을 압축해 놓은 과정이지 않았나 싶습니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="August 21, 2018">August 21, 2018</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/go_cscope/" rel="bookmark">cscope 사용(Go)</a>
						</h1>
					</header>
					<div class="entry-content">
						<h2 id="go언어-개발-환경추가">Go언어 개발 환경(추가)</h2>
<p>Go언어로 작성한 코드를 분석하기 위해서 cscope가 필요할 때가 있습니다.<br>
vim에서 cscope를 사용하기 위한 과정을 정리해 보려고 합니다.</p>
<h2 id="cscope를-설치합니다">cscope를 설치합니다.</h2>
<pre><code>$ sudo apt-get install cscope
</code></pre><h2 id="mkscopesh-파일을-만듭니다">mkscope.sh 파일을 만듭니다.</h2>
<p>mkscope.sh의 내용은 다음과 같습니다.<br>
이 스크립트는 <a href="https://www.cnblogs.com/shaohef/p/7358111.html">https://www.cnblogs.com/shaohef/p/7358111.html</a> 의 내용을 수정해서 사용했습니다.</p>
<pre><code>#!/bin/bash

# 기존에 존재하던 files와 out 파일을 제거합니다
rm cscope.files cscope.out

# $GOROOT가 존재하지 않으면 설정합니다.
if [&quot;$GOROOT&quot; = &quot;&quot;]; then
    echo &quot;GOROOT is not set&quot;
    GOROOT=`go env | grep &quot;GOROOT&quot; | cut -d &quot;=&quot; -f2`
    GOROOT=${GOROOT#\&quot;}
    GOROOT=${GOROOT%\&quot;}
fi
echo $GOROOT

# Go 표준 패키지
go_src=$GOROOT/src

# Go언어 표준 패키지로 제공되는 go 파일의 경로를 cscope.files로 만듭니다.
find $go_src -name &quot;*.go&quot; -print &gt; cscope.files
# 현재 디렉토리 존재하는 go 파일의 경로를 cscope.files로 만듭니다.
find . -name &quot;*.go&quot; -print &gt; cscope.files


# cscope 옵션으로 -b 옵션을 사용해서 데이터 베이스 생성 후에 심볼 찾기 화면이 안보이게 하고, 
# -k 옵션을 사용해서 default include(/usr/include) 경로의 내용을 사용하지 않도록 합니다.
if cscope -b -k; then
    echo &quot;Done&quot;
else
    echo &quot;Failed&quot;
    exit 1
fi

</code></pre><h2 id="mkscopesh-의-사용권한을-변경합니다">mkscope.sh 의 사용권한을 변경합니다.</h2>
<pre><code>$ sudo chmod 755 mkscope.sh
</code></pre><h2 id="mkscopesh를-사용하기-편리하게-경로를-이동합니다usrlocalbin">mkscope.sh를 사용하기 편리하게 경로를 이동합니다.(/usr/local/bin)</h2>
<pre><code>$ sudo mv mkscope.sh /usr/local/bin
</code></pre><h2 id="cscope를-편리하게-사용하기-위해서-quickr-cscopevim을-설치">cscope를 편리하게 사용하기 위해서 quickr-cscope.vim을 설치</h2>
<p>vimrc.local에 vundle을 추가</p>
<pre><code>Plugin 'ronakg/quickr-cscope.vim'
</code></pre><p>quickr-cscope의 단축키는 다음과 같습니다.</p>
<pre><code>&lt;leader&gt;g : 커서 아래의 함수가 선언되어 있는 곳으로 이동합니다.
&lt;leader&gt;s: 커서 아래의 단어를 검색을 합니다.
&lt;leader&gt;c: 커서 아래의 함수를 호출하는 함수들을 찾습니다.
&lt;leader&gt;f: 커서 아래의 단어로된 파일을 검색합니다.
&lt;leader&gt;i: 커서 아래의 함수 또는 키워드의 정의 내용을 출력합니다.
&lt;leader&gt;t: 커서 아래의 단어로된 문자열을 검색합니다.
&lt;leader&gt;d: 커서 아래의 함수가 호출하는 함수들을 출력합니다.
&lt;leader&gt;e: egrep를 사용한 검색을 합니다.
</code></pre><p>그리고 다음과 같이 직접 사용할 수 도 있습니다.</p>
<pre><code>:cs find {g|s|c|f|i|t|d|e} keyword 
</code></pre><h2 id="분석하기">분석하기</h2>
<p>vi를 시작하기 전에 항상 mkscope.sh를 실행해서 수정된 내용이 cscope에서 사용하는 데이터베이스인 cscope.out에 반영될 수 있도록 합니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="July 31, 2018">July 31, 2018</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/git_reset/" rel="bookmark">git push된 내용을 특정한 commit으로 되돌리기</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>&ldquo;iss-123&rdquo; 브랜치에서 작업하던 내용을 실수로 &ldquo;iss-133&rdquo; 브랜치로 push 하는 어이없는 실수를 했을때 &ldquo;iss-133&quot;에 push 된 내용을 이전으로 되돌려 놓아야 합니다.</p>
<p>git log로 이전 commit의 id를 확인합니다. (ex, d50fd96d2d7e5e5cf689b0943f2b2d20d4c2dda4)</p>
<pre><code>[iss-133] $ git reset --hard d50fd96d2d7e5e5cf689b0943f2b2d20d4c2dda4
</code></pre><p>이제 변경된 내용을 push 합니다.</p>
<pre><code>[iss-13] $ git push --force origin prj
</code></pre><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="July 12, 2018">July 12, 2018</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/go_key_exists_in_map/" rel="bookmark">map에 key가 존재하는지 확인</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>map을 사용할때 해당하는 키가 map에 존재하는지 확인이 필요할 때가 있습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">target</span>[<span style="color:#66d9ef">string</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">item</span>
<span style="color:#f92672">...</span>
<span style="color:#a6e22e">target</span>[<span style="color:#e6db74">&#34;apple&#34;</span>] = <span style="color:#a6e22e">itm1</span>
<span style="color:#a6e22e">target</span>[<span style="color:#e6db74">&#34;orange&#34;</span>] = <span style="color:#a6e22e">itm2</span>
<span style="color:#f92672">...</span>

<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">target</span>[<span style="color:#e6db74">&#34;kiwi&#34;</span>]
</code></pre></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="February 21, 2018">February 21, 2018</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/go_writing-a-unit-test/" rel="bookmark">Go언어 프로젝트에서 테스트 코드 작성 경험</a>
						</h1>
					</header>
					<div class="entry-content">
						<h2 id="테스트-코드는-왜">테스트 코드는 왜?</h2>
<p>현재 프로젝트를 진행 중 코딩을 할 때면 계속해서 의심과 두려움이 들었다.</p>
<p>&ldquo;내가 제대로 작성하고 있는 게 맞나?&rdquo;<br>
&ldquo;이렇게 작성하면 다른 데에서 문제가 생기는 건 아닌가?&rdquo;</p>
<p>그리고 이런 걱정들은 다음의 2가지 원인 때문이지 않을까 라고 생각하게 되었다.<br>
첫 번째, 코드 작성 후 실행해서 결과를 확인하기 위해서 개인 개발 환경을 MessageQueue와 내가 보낸 요청에 대해 기대하는 응답을 전달해줄 MessageQueue 반대편의 모듈을 구성하기가 쉽지 않다는 것이었다.<br>
두 번째, 기존에 코딩하면서 세워 놓았던 원칙을 기억하지 못하고 그 원칙에 어긋나는 코드를 작성하게 되었을 때, 전체 시스템에서 동작 중 알 수 없는 순간에 오동작하는 경우 때문이었다.</p>
<p>&ldquo;테스트 주도 개발 TDD 실천법과 도구&rdquo; 라는 책과 함께 몇 가지의 블로그 포스팅 그리고 몇 권의 책을 더 읽어 보면서 테스트 코드를 작성해 보면 문제의 원인을 해결할 수 있지 않을까 싶었다.<br>
그래서 진행중인 프로젝트들에 테스트 코드를 작성해 보기로 했다.</p>
<h2 id="테스트-코드는-뭘">테스트 코드는 뭘?</h2>
<p>테스트 코드를 작성할 때에 주의해야 할 점은 다음과 같다.</p>
<ol>
<li>&ldquo;질문 -&gt; 응답 -&gt; 정제 -&gt; 반복&rdquo; 의 과정을 거쳐서, 테스트를 작성하고 실패하고 정리하고  이걸 반복한다.</li>
<li>테스트 작성의 최소 단위는 함수이다. 하나의 함수를 기준으로 테스트 코드를 작성할 수 있다.</li>
<li>설계할 때 동작을 먼저 정의하고 그 동작에 필요한 속성을 고려한다.</li>
</ol>
<h2 id="테스트-코드는-어떻게">테스트 코드는 어떻게?</h2>
<p>Go 언어에서 테스트 코드의 작성은 표준으로 제공하는 “testing” 패키지만으로 가능합니다.</p>
<p>테스트 코드 작성과 확인을 좀 더 편리하게 도와주는 다음과 같은 도구들의 도움을 받을 수도 있습니다.</p>
<ul>
<li>testify ( go get -u github.com/stretchr/testify )</li>
<li>goconvey ( go get -u github.com/smartystreets/goconvey )</li>
</ul>
<p>testify는 assert, http, mock, require, suite 와 같은 패키지를 제공해서 좀 더 편리한 검증을 할 수 있도록 도와 줍니다. 그리고 goconvey는 터미널(go test)에서 테스트 결과를 확인하던걸 브라우저에서 편리하게 확인할 수 있게 해주는 도구입니다.</p>
<p>goconvey의 사용은 테스트를 진행할 디렉토리에서 goconvey를 실행해 주면 웹브라우저가 실행되면서 다음과 같은 화면으로 현재 프로젝트의 테스트 상황을 한 눈에 볼 수 있게 해줍니다.<br>
<img src="/image/writing-a-unit-test/scr-1.png" alt=""></p>
<p>또한, 현재 coverage 상태를 다음과 같이 볼 수도 있습니다.<br>
<img src="/image/writing-a-unit-test/scr-2.png" alt=""></p>
<h2 id="테스트-코드-작성">테스트 코드 작성</h2>
<p>테스트 함수 작성 요령</p>
<ul>
<li>
<p>테스트 대상 함수와 이름을 1:1로 일치 시킵니다.</p>
<pre><code>대상: Getbalance() {...}  
테스트: TestGetbalance(...) {...}
</code></pre></li>
<li>
<p>테스트 대상 메소드의 이름을 메소드 단위로 작성을 하면서 뒤에 추가적인 케이스에 대한 내용을 추가합니다.</p>
<pre><code>func Test_Withdraw_마이너스통장인출(...) {...}
</code></pre></li>
<li>
<p>특정한 메소드가 아닌 테스트 시나리오를 대상으로 하는 테스트 메소드를 작성하는 경우도 있습니다.</p>
<pre><code>func Test_VIP고객이_인출할때_수수료계산(...) {...}
</code></pre></li>
<li>
<p>테스트 케이스 시나리오는 정상적인 흐름에 대한 결과를 확인하거나, 예외나 에러 상황에 대한 결과를 확인하는 방법이 있을 수 있습니다. 그리고 a+b의 동작을 하는 메소드에 a와 b를 넣고 실제로 a+b를 한 결과와 일치하는지 확인해 보는 식의 경우가 있습니다.</p>
</li>
</ul>
<p>Go 언어로 만들어진 프로젝트에서 테스트 코드를 작성하기 위해서는 몇 가지 규칙이 있습니다.</p>
<ul>
<li>
<p>파일명이 &ldquo;xxx_test.go&rdquo; 와 같이 파일명 뒤에 _test라고 지정합니다.</p>
</li>
<li>
<p>테스트를 진행할 함수의 이름은 &ldquo;Test&rdquo; 로 시작되어야 합니다.</p>
<pre><code>func Test_Minus_작은_수에서_큰_수_빼기(t *testing.T) { }
</code></pre></li>
<li>
<p>위의 ex에서 보이는 것 처럼 testing.T 를 인자로 받습니다. testing.T 타입은 Error, Fail, Fatal, Log 등과 같은 테스트에 필요한 요소들을 갖고 있습니다.
(자세한 내용은 <a href="https://golang.org/pkg/testing/">https://golang.org/pkg/testing/</a> 을 참고)</p>
</li>
</ul>
<h2 id="테스트-코드-작성-예1">테스트 코드 작성 예(1)</h2>
<p>간단한 더하기 계산을 하는 패키지를 만들면서 필요한  테스트 코드를 작성하는 예를 한번 보겠습니다.<br>
테스트 코드는 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// add_test.go
</span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">add</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;testing&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestAdd</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
	<span style="color:#75715e">//arrange
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>, <span style="color:#a6e22e">res</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">x</span> = <span style="color:#ae81ff">2</span>
	<span style="color:#a6e22e">y</span> = <span style="color:#ae81ff">3</span>

	<span style="color:#75715e">//act
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">res</span> = <span style="color:#a6e22e">Add</span>(<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span>)

	<span style="color:#75715e">//assert
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">5</span> {
		<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Add의 결과가 옳바르지 않습니다&#34;</span>)
	}
}
</code></pre></div><p>add 패키지의 구현은 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// add.go
</span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">add</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Add</span>(<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">y</span>
}
</code></pre></div><p>이제 테스트를 진행해서 결과를 보기 위해서 다음과 같이 실행합니다.</p>
<pre><code>$ go test -v
=== RUN   TestAdd
--- PASS: TestAdd (0.00s)
</code></pre><h2 id="테스트-코드-작성-예2">테스트 코드 작성 예(2)</h2>
<p>이번에는 testify/assert 패키지를 이용한 테스트 코드 작성 예를 한번 보도록 하겠습니다. 그리고 현재 프로젝트 디렉토리에서 goconvey를 실행해서 브라우저를 통해서 테스트 함수들의 성공 또는 실패를 계속해서 확인해겠습니다.</p>
<pre><code>sample_1$ goconvey

2018/02/20 17:02:39 goconvey.go:61: Initial configuration: [host: 127.0.0.1] [port: 8080] [poll: 250ms] [cover: true]
2018/02/20 17:02:42 tester.go:19: Now configured to test 10 packages concurrently.
2018/02/20 17:02:42 goconvey.go:192: Serving HTTP at: http://127.0.0.1:8080
2018/02/20 17:02:42 integration.go:122: File system state modified, publishing current folders... 0 3038222316
2018/02/20 17:02:42 goconvey.go:118: Received request from watcher to execute tests...
2018/02/20 17:02:42 executor.go:69: Executor status: 'executing'
2018/02/20 17:02:42 coordinator.go:46: Executing concurrent tests: sample_1
2018/02/20 17:02:42 goconvey.go:105: Launching browser on 127.0.0.1:8080
2018/02/20 17:02:46 goconvey.go:113: ATTENTION: default value of option force_s3tc_enable overridden by environment.
기존 브라우저 세션에 새 창을 생성했습니다.
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// oprcfg.go
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">CfgItem</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">Name</span>        <span style="color:#66d9ef">string</span>
  <span style="color:#a6e22e">Value</span>       <span style="color:#66d9ef">string</span>
  <span style="color:#a6e22e">Owner</span>       <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Config</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">Cfg</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>][]<span style="color:#a6e22e">CfgItem</span>
}
 
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewConfig</span>() (<span style="color:#f92672">*</span><span style="color:#a6e22e">Config</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#a6e22e">oc</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Config</span>{}
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">Cfg</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>][]<span style="color:#a6e22e">CfgItem</span>)
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">oc</span>, <span style="color:#66d9ef">nil</span>
}
 
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">oc</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Config</span>) <span style="color:#a6e22e">GetOprCfg</span>(<span style="color:#a6e22e">owner</span> <span style="color:#66d9ef">string</span>) []<span style="color:#a6e22e">OprCfg</span> {
  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">owner</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
  }
  
  <span style="color:#a6e22e">globalCategory</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;global&#34;</span>
  <span style="color:#a6e22e">srchCategory</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">owner</span>
 
  <span style="color:#a6e22e">globalConfigItem</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">Cfg</span>[<span style="color:#a6e22e">globalCategory</span>]
  <span style="color:#a6e22e">srchConfigItem</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">Cfg</span>[<span style="color:#a6e22e">srchCategory</span>]
 
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resOpcf</span> []<span style="color:#a6e22e">OprCfg</span>
 
  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">cf</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">globalConfigItem</span> {
    <span style="color:#a6e22e">opcf</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Value</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Owner</span>}
    <span style="color:#a6e22e">resOpcf</span> = append(<span style="color:#a6e22e">resOpcf</span>, <span style="color:#a6e22e">opcf</span>)
  }
 
  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">cf</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">srchConfigItem</span> {
    <span style="color:#a6e22e">opcf</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Value</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#a6e22e">cf</span>.<span style="color:#a6e22e">Owner</span>}
    <span style="color:#a6e22e">resOpcf</span> = append(<span style="color:#a6e22e">resOpcf</span>, <span style="color:#a6e22e">opcf</span>)
  }
 
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">resOpcf</span>
}
</code></pre></div><p>Config 객체를 생성하는 NewConfig() 함수가 있고, Config에서 owner에 해당하는 OprCfg를 반환하는 GetOprCfg() 함수가 있습니다.<br>
이 두 함수에 대한 테스트 코드를 다음과 같이 작성했습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// oprcfg_test.go
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Test_Config_New</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
  <span style="color:#75715e">// arrange
</span><span style="color:#75715e"></span> 
  <span style="color:#75715e">// act
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">oc</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewConfig</span>()
 
  <span style="color:#75715e">// assert
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">NotNil</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">oc</span>)
}
 
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Test_GetOprCfg</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
  <span style="color:#75715e">// arrange
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">oc</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewConfig</span>()
 
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key1&#34;</span>, <span style="color:#e6db74">&#34;value1&#34;</span>, <span style="color:#e6db74">&#34;key1-value1&#34;</span>, <span style="color:#e6db74">&#34;owner1&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key2&#34;</span>, <span style="color:#e6db74">&#34;value2&#34;</span>, <span style="color:#e6db74">&#34;key2-value2&#34;</span>, <span style="color:#e6db74">&#34;owner2&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key3&#34;</span>, <span style="color:#e6db74">&#34;value3&#34;</span>, <span style="color:#e6db74">&#34;key3-value3&#34;</span>, <span style="color:#e6db74">&#34;owner1&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key4&#34;</span>, <span style="color:#e6db74">&#34;value4&#34;</span>, <span style="color:#e6db74">&#34;key4-value4&#34;</span>, <span style="color:#e6db74">&#34;owner1&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key5&#34;</span>, <span style="color:#e6db74">&#34;value5&#34;</span>, <span style="color:#e6db74">&#34;key5-value5&#34;</span>, <span style="color:#e6db74">&#34;owner2&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key6&#34;</span>, <span style="color:#e6db74">&#34;value6&#34;</span>, <span style="color:#e6db74">&#34;key6-value6&#34;</span>, <span style="color:#e6db74">&#34;owner3&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key7&#34;</span>, <span style="color:#e6db74">&#34;value7&#34;</span>, <span style="color:#e6db74">&#34;key7-value7&#34;</span>, <span style="color:#e6db74">&#34;owner1&#34;</span>)
  <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">SetCfgItem</span>(<span style="color:#e6db74">&#34;key8&#34;</span>, <span style="color:#e6db74">&#34;value8&#34;</span>, <span style="color:#e6db74">&#34;key8-value8&#34;</span>, <span style="color:#e6db74">&#34;global&#34;</span>)
 
  <span style="color:#75715e">// act
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">opcfs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">oc</span>.<span style="color:#a6e22e">GetOprCfg</span>(<span style="color:#e6db74">&#34;owner1&#34;</span>)
  <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#a6e22e">opcfs</span>)
 
  <span style="color:#75715e">// assert
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">res</span> []<span style="color:#a6e22e">OprCfg</span>
  <span style="color:#a6e22e">res</span> = make([]<span style="color:#a6e22e">OprCfg</span>, <span style="color:#ae81ff">5</span>)
 
  <span style="color:#75715e">// res에는 global이 먼저 쌓이고, 타겟 owner가 쌓인다
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>[<span style="color:#ae81ff">0</span>] = <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key8&#34;</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#e6db74">&#34;value8&#34;</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#e6db74">&#34;global&#34;</span>}
  <span style="color:#a6e22e">res</span>[<span style="color:#ae81ff">1</span>] = <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key1&#34;</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#e6db74">&#34;value1&#34;</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#e6db74">&#34;owner1&#34;</span>}
  <span style="color:#a6e22e">res</span>[<span style="color:#ae81ff">2</span>] = <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key3&#34;</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#e6db74">&#34;value3&#34;</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#e6db74">&#34;owener1&#34;</span>}
  <span style="color:#a6e22e">res</span>[<span style="color:#ae81ff">3</span>] = <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key4&#34;</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#e6db74">&#34;value4&#34;</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#e6db74">&#34;owner1&#34;</span>}
  <span style="color:#a6e22e">res</span>[<span style="color:#ae81ff">4</span>] = <span style="color:#a6e22e">OprCfg</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key7&#34;</span>, <span style="color:#a6e22e">Value</span>: <span style="color:#e6db74">&#34;value7&#34;</span>, <span style="color:#a6e22e">Owner</span>: <span style="color:#e6db74">&#34;owner1&#34;</span>}
  <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">True</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">ObjectsAreEqual</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">opcfs</span>))
}
</code></pre></div><p>테스트 코드를 작성하기 위해서 “Test” 로 시작하는 함수명을 갖도록 했습니다.<br>
func Test_Config_New(t *testing.T) 함수에서 보면, 다음과 같은 주석을 볼 수 있습니다.</p>
<pre><code>// arrange
...
// act
...
// assert
...
</code></pre><p>이는 테스트 코드를 작성하기 위한 일종의 템플릿 같은것 입니다.<br>
arrange: 테스트를 진행하기 전에 필요한 준비 작업 정도의 코드들이 위치할 수 있습니다. 
act: 실제로 테스트 되어서 결과를 확인하고자 하는 동작을 구현합니다.<br>
assert: act에서 진행한 동작에 대한 결과를 확인하는 용도입니다.</p>
<p>첫 번째 테스트 코드인 Test_Config_New는 Config 객체의 생성이 잘 되는지 확인하기 위한 테스트입니다.</p>
<p>arrange 절은 준비할 작업이 별도로 없기 때문에 생략 되었습니다.<br>
act 절에서 확인하고자 하는 NewConfig() 함수를 사용해서 Config 객체를 생성합니다. 
assert 절에서 생성된 객체가 생성이 잘 되었는지 확인하는 과정으로 객체가 nil인지를 확인 합니다. 여기에서 testify/assert 패키지를 사용합니다.</p>
<p>assert 패키지에는 다양한 검증을 위한 기능을 제공하고 있습니다. 간단하게 assert.NotNil은 주어진 객체가 nil이 아닌지 확인하는 함수입니다. assert의 다양한 기능에 대해서는 godoc( <a href="https://godoc.org/github.com/stretchr/testify/assert">https://godoc.org/github.com/stretchr/testify/assert</a> ) 에서 확인해볼 수 있습니다.</p>
<p>두 번째 테스트 코드인 Test_GetOprCfg는 Config에  다양한 owner의 CfgItem들이 섞여 있는 중에서, 특정 owner와 onwer가 global로 지정된 CfgItem을 찾아서 OprCfg 만들어서 반환해주는걸 확인하기 위한 용도의 테스트입니다.</p>
<p>arrange 절에서 GetOprCfg 함수를 테스트하기 위해서 Config 객체를 생성해서 임의의 설정(CfgItem) 값들을 owner를 달리해서 입력(SetCfgItem) 합니다.<br>
act 절에서 GetOprCfg 함수에 owner로 &ldquo;owner1” 를 전달해서 OprCfg 슬라이스를 반환값으로 받습니다.<br>
assert 절에서는 결과 값으로 받은 OperCfg 슬라이스가 global과 owner1이 owner인 값들만을 전달받았는지를 확인합니다.</p>
<p>assert 패키지의 ObjectsAreEqual은 두 Object가 일치하는지를 확인합니다.<br>
assert 패키지의 True는 전달받은 값이 true인지를 확인합니다.</p>
<p>이렇게 기본적인 테스트 코드를 작성할 수 있습니다. 그렇지만 모든 상황에 대해서 테스트 코드를 작성할 수 있는 것은 아니며, 다음과 같은 경우에 대해서는 테스트 코드를 작성하는 데 한계가 있습니다.</p>
<ul>
<li>동시성 문제</li>
<li>접근제한자</li>
<li>GUI</li>
<li>의존성 모듈 테스트</li>
</ul>
<p>위의 경우는 고민하지 말고 테스트 코드 만들기를 포기하려고 합니다.</p>
<h2 id="테스트-코드-작성-예3">테스트 코드 작성 예(3)</h2>
<p>의존성의 경우는 테스트더블을 이용해서 어느 정도는 해결(?) 할 수 있다. 예를 들어 다음과 같은 경우입니다.</p>
<pre><code>패스워드 저장의 구현을 위해서 암호화 모듈을 제공 받아야 합니다. 
암호화를 위한 인터페이스와 암호화 방식이 미리 정해져 있다면, 암호화 모듈을 Mock으로 제작할 수 있습니다. 
미리 약속된 인터페이스 기능들을 Cipher라는 인터페이스로 정의하고 
그 인터페이스를 구현한 MockMD5Cipher를 만들어서 encrypt와 decrypt 내부에서 
“potato”와 potato의 md5 hash 값을 무조건 반환해 줍니다.
</code></pre><p>이러한 경우를 우리 프로젝트에서 생각해 보면 MessageQueue에 의존적인 환경에서 개발하고 있는걸 생각해 볼 수 있습니다. MessageQueue의 동작을 테스트더블 객체로 만들어서 테스트 코드를 작성해 볼 수 있습니다.</p>
<p>&ldquo;테스트더블&rdquo; 이라는 용어는 대역, 스턴트맨을 의미하는 스턴트 더블이라는 단어에서 유래되었습니다.<br>
데스트더블의 분류에는 &ldquo;Dummy&rdquo;, &ldquo;Stub&rdquo;, &ldquo;Fake&rdquo;, &ldquo;Spy&rdquo;, &ldquo;Mock&rdquo; 이 있다. 이들의 정의 또는 쓰임새는 다음과 같습니다.</p>
<ul>
<li>Dummy: 객체의 겉모양만 만들어서 테스트를 진행할 수 있도록 하는 목적의 객체입니다. (객체가 생성만 되면 되는 경우에 사용합니다)</li>
<li>Stub: 특정 메소드가 호출되어야 정상적인 동작이 가능한 경우에 사용하는 객체입니다.(객체가 특정 상태나 모습을 갖추면 되기 때문에 필요한 메소드에 하드 코딩으로 결과 값 등을 작성합니다.)</li>
<li>Fake: 여러 상황을 대표하기 위해 Stub보다 좀 더 복잡한 구현이 들어간 객체입니다.</li>
<li>Spy: 특정한 메소드가 호출되었는지 확인하기 위한 용도로 호출된 내역을 내부에서 기록하는 로직이 들어갑니다.</li>
<li>Mock: 위의 테스트더블 객체들은 상태에 대한 확인이 주된 용도였다면 Mock은 행위를 검증하는 용도로 많이 사용됩니다.</li>
</ul>
<p>이제 MessageQueue에 의존적인 부분을 테스트더블 객체로 만들어서 테스트 코드를 작성해 보려고 합니다.<br>
변경된 이벤트 정보를 확인하는 GetChangeEventInfo 함수에 대한 테스트 코드를 작성해 보겠습니다.<br>
테스트 코드를 작성하고자 하는 전체 로직은 다음과 같습니다.</p>
<ol>
<li>GetChangeEventInfo 함수가 호출되는 경우는 외부에서 이벤트가 변경되었음을 알리는 요청이 들어 옵니다.</li>
<li>전달받은 eventID 값을 이용해서 GetChangeEventInfo 함수가 MessageQueue에 연결되어 있는 Agent에게 변경된 이벤트 정보를 전달해 달라고 요청합니다.</li>
<li>Agent는 Database에서 조회해서 MessageQueue에 결과를 전달할것 입니다.</li>
<li>sample_1은 MessageQueue를 통해서 전달된 응답을 수집할것 입니다.</li>
<li>결과로 받은 값을 확인 합니다.</li>
</ol>
<p>테스트 코드를 작성하기 이전의 코드 상태는 다음과 같았습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">d</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Agent</span>) <span style="color:#a6e22e">GetChangeEventInfo</span>(<span style="color:#a6e22e">eventID</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">EventInfo</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#f92672">*</span><span style="color:#a6e22e">msg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MakeChangeMsg</span>(<span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">blah</span><span style="color:#f92672">-</span><span style="color:#a6e22e">blah</span><span style="color:#f92672">-</span><span style="color:#a6e22e">chg</span><span style="color:#f92672">-</span><span style="color:#a6e22e">key</span><span style="color:#960050;background-color:#1e0010">”</span>, <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">agent</span><span style="color:#960050;background-color:#1e0010">”</span>)<span style="color:#f92672">*</span>
 
  <span style="color:#a6e22e">eventUUID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">UUID_Data</span> { <span style="color:#a6e22e">UUID</span>: <span style="color:#a6e22e">eventID</span> }
  <span style="color:#a6e22e">any</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Encoding</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">eventUUID</span>)
  <span style="color:#f92672">*</span><span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">Payload</span>(<span style="color:#a6e22e">any</span>)
 
  <span style="color:#75715e">/* message queue 관련 기타 등등의 구현 들
</span><span style="color:#75715e">      ...
</span><span style="color:#75715e">  */</span>
 
  <span style="color:#a6e22e">SendMessage</span>(<span style="color:#a6e22e">msg</span>)
  <span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">RecvMessage</span>()

  <span style="color:#a6e22e">data</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">val</span>.<span style="color:#a6e22e">GetPayload</span>()
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ei</span> <span style="color:#a6e22e">EventInfo</span>
  <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Decoding</span>(<span style="color:#a6e22e">data</span>[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>)
 
  <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>위의 코드 중에서 굵게 표시된 부분은 sample_1 이 아닌 외부 요소(MessageQueue)들에 대한 동작을 구현한 부분입니다.<br>
그리고 이 부분은 MessageQueue에 무언가를 요청하는 과정에서 매번 반복되기도 합니다. 그래서 이 부분을 별도의 함수로 구현하기로 했습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">d</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Agent</span>) <span style="color:#a6e22e">GetChangeEventInfo</span>(<span style="color:#a6e22e">eventID</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">EventInfo</span>, <span style="color:#66d9ef">error</span>) { 
  <span style="color:#a6e22e">sendInfo</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">MqSendInfo</span>{
    <span style="color:#a6e22e">key</span>:     <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">blah</span><span style="color:#f92672">-</span><span style="color:#a6e22e">blah</span><span style="color:#f92672">-</span><span style="color:#a6e22e">chg</span><span style="color:#f92672">-</span><span style="color:#a6e22e">key</span><span style="color:#960050;background-color:#1e0010">”</span>,
    <span style="color:#a6e22e">recv</span>: <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">agent</span><span style="color:#960050;background-color:#1e0010">”</span>,
  }
 
  <span style="color:#a6e22e">eventUUID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">UUID_Data</span>{ <span style="color:#a6e22e">UUID</span>: <span style="color:#a6e22e">eventID</span> }
  <span style="color:#a6e22e">any</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Encoding</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">eventUUID</span>)
 
  <span style="color:#a6e22e">anyData</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MqSend</span>(<span style="color:#a6e22e">sendInfo</span>, <span style="color:#a6e22e">any</span>)
  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span> }
 
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ei</span> <span style="color:#a6e22e">EventInfo</span>
  <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Decoding</span>(<span style="color:#a6e22e">anyData</span>[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>)

  <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>위와 같이 코드를 별도의 함수(MqSend)로 빼놓고, MqSendInfo라는 struct를 인자로 받도록 변경을 했습니다. 함수와 구조체는 다음과 같이 작성 되었습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MqSendInfo</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">key</span>     <span style="color:#66d9ef">string</span>
  <span style="color:#a6e22e">recv</span> <span style="color:#66d9ef">string</span>
}
 
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MqSend</span>(<span style="color:#a6e22e">info</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MqSendInfo</span>, <span style="color:#a6e22e">any</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>) ([]<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#a6e22e">msg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MakeChangeMsg</span>(<span style="color:#a6e22e">info</span>.<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">info</span>.<span style="color:#a6e22e">recv</span>)
  
  <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">Payload</span>(<span style="color:#a6e22e">any</span>)
 
  <span style="color:#75715e">/* message queue 관련 기타 등등의 구현 들 
</span><span style="color:#75715e">     ...
</span><span style="color:#75715e">  */</span>
 
  <span style="color:#a6e22e">SendMessage</span>(<span style="color:#a6e22e">msg</span>) 
  <span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">RecvMessage</span>()
 
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">val</span>.<span style="color:#a6e22e">Msgs</span>, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>이렇게 해서 중복된 코드를 많이 줄일 수는 있었습니다. 그렇지만 MessageQueue의 의존성은 여전히 남아 있습니다.</p>
<p>테스트 코드를 작성하는 입장에서는 우리가 전달한 eventID의 값을 이용해서 MqSend 함수가 EventInfo 값을 돌려주면됩니다. MqSend가 호출되었는지와 그 함수의 결과 값을 이용해서 GetChangeEventInfo가 우리가 원하는 결과 값을 만들어서 돌려주면 성공적으로 동작한 걸로 간주할 수가 있게 됩니다.</p>
<p>그래서 MqSend 함수를 가짜로 구현하고 있는 테스트더블 객체를 만들려고 합니다. +
우선 위의 MqSendInfo 구조체와 MqSend 함수의 이름을 MqMsg 구조체와 구조체의 메소드 Send로 변경하였습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Messenger</span> <span style="color:#66d9ef">interface</span> {
  <span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">any</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>) ([]<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>, <span style="color:#66d9ef">error</span>)
}
 
<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MqMsg</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">key</span>     <span style="color:#66d9ef">string</span>
  <span style="color:#a6e22e">recv</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">m</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MqMsg</span>) <span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">any</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>) ([]<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#a6e22e">msg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MakeChangeMsg</span>(<span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">recv</span>)
 
  <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">Payload</span>(<span style="color:#a6e22e">any</span>)
 
  <span style="color:#75715e">/* message queue 관련 기타 등등의 구현 들 
</span><span style="color:#75715e">     ...
</span><span style="color:#75715e">  */</span>
 
  <span style="color:#a6e22e">SendMessage</span>(<span style="color:#a6e22e">msg</span>)
  <span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">RecvMessage</span>()

  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">val</span>.<span style="color:#a6e22e">Msgs</span>, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>이제 테스트 코드를 다음과 같이 작성해 볼 수 있습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MockAgentMsgr</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">mock</span>.<span style="color:#a6e22e">Mock</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">m</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">MockAgentMsgr</span>) <span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">any</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>) ([]<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#a6e22e">args</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Called</span>(<span style="color:#a6e22e">any</span>, <span style="color:#a6e22e">wait</span>)
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#ae81ff">0</span>).([]<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>), <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#ae81ff">1</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Test_GetChangeEventInfo</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
  <span style="color:#75715e">// arrange
</span><span style="color:#75715e"></span> 
  <span style="color:#75715e">// 입력 값
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">eventID</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;event--uuid-1&#34;</span>
 
  <span style="color:#a6e22e">UUID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">UUID_Data</span> { <span style="color:#a6e22e">UUID</span>: <span style="color:#a6e22e">eventID</span> }
  <span style="color:#a6e22e">par1</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Encoding</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">UUID</span>)
 
  <span style="color:#75715e">// 출력 값
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resAnytypes</span> []<span style="color:#f92672">*</span><span style="color:#a6e22e">Any</span>
  <span style="color:#a6e22e">res1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">EventInfo</span> { <span style="color:#a6e22e">UUID</span>: <span style="color:#a6e22e">eventID</span>, <span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;event1&#34;</span>, <span style="color:#a6e22e">Type</span>: <span style="color:#a6e22e">ET_START</span> }
 
  <span style="color:#a6e22e">resAnytype1</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Encoding</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res1</span>)
  <span style="color:#a6e22e">resAnytypes</span> = append(<span style="color:#a6e22e">resAnytypes</span>, <span style="color:#a6e22e">resAnytype1</span>)
 
  <span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">MockAgentMsgr</span>{}
  <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">On</span>(<span style="color:#e6db74">&#34;Send&#34;</span>, <span style="color:#a6e22e">par1</span>).<span style="color:#a6e22e">Return</span>(<span style="color:#a6e22e">resAnytypes</span>, <span style="color:#66d9ef">nil</span>)
 
  <span style="color:#a6e22e">agentMg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewAgent</span>(<span style="color:#a6e22e">m</span>)
 
  <span style="color:#75715e">// act
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">event</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agentMg</span>.<span style="color:#a6e22e">GetChangeEventInfo</span>(<span style="color:#a6e22e">eventID</span>)
 
  <span style="color:#75715e">// assert
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>)
  <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">True</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">ObjectsAreEqual</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">res1</span>, <span style="color:#a6e22e">event</span>))
  <span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">True</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">AssertCalled</span>(<span style="color:#a6e22e">t</span>, <span style="color:#e6db74">&#34;Send&#34;</span>, <span style="color:#a6e22e">par1</span>, <span style="color:#66d9ef">true</span>))
}
</code></pre></div><p>MqMsg의 테스트더블을 구현하기 위해서 Messenger 인터페이스에 Send 메소드를 정의했습니다.<br>
MockAgentMsgr 구조체는 Messenger 인터페이스를 구현한 테스트더블 입니다.<br>
MockAgentMsgr의 Send 메소드의 구현에서는 입력된 값과 반환되어야 할 값에 대해서 지정을 하고 있습니다.<br>
이제 Test_GetChangeEventInfo 함수에서 입력값을 만들고 Send 메소드가 호출되었을 때 반환해야 할 출력값도 지정 합니다. MessageQueue에서 어떤 동작을 하든지 상관없이 입력된 값에 의해서 정해진 결과 값을 받는다는 가정 입니다. 그래서 작성된 코드 중에 다음과 같은 내용이 있습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">MockAgentMsgr</span>{}
<span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">On</span>(<span style="color:#e6db74">&#34;Send&#34;</span>, <span style="color:#a6e22e">par1</span>).<span style="color:#a6e22e">Return</span>(<span style="color:#a6e22e">resAnytypes</span>, <span style="color:#66d9ef">nil</span>)
</code></pre></div><p>Send 메소드가 호출될 때 입력값에 대해서 출력값을 정의해 놓은것 입니다.</p>
<p>그런데 현재의 실행 코드상에서는 정해진 형태(MqMsg의 Send 메소드)만을 호출하는 구조입니다. 이를 변경해야 할 필요가 있습니다. 그래서 우리는 Agent 객체를 생성하는 시점에 MessageQueue에 대한 정보를 지정해서 받는 형식으로 변경 했습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Agent</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#a6e22e">Msgr</span> <span style="color:#a6e22e">Messenger</span>
}
 
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewAgent</span>(<span style="color:#a6e22e">msgr</span> <span style="color:#a6e22e">Messenger</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Agent</span> {
  <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Agent</span>{<span style="color:#a6e22e">Msgr</span>: <span style="color:#a6e22e">msgr</span>}
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">d</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Agent</span>) <span style="color:#a6e22e">GetChangeEventInfo</span>(<span style="color:#a6e22e">eventID</span> <span style="color:#66d9ef">string</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">EventInfo</span>, <span style="color:#66d9ef">error</span>) {
  <span style="color:#a6e22e">eventUUID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">UUID_Data</span>{ <span style="color:#a6e22e">UUID</span>: <span style="color:#a6e22e">evnetID</span> }
  <span style="color:#a6e22e">any</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Encoding</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">eventUUID</span>)
 
  <span style="color:#a6e22e">anyData</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">Msgr</span>.<span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">any</span>)
  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span> }
 
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ei</span> <span style="color:#a6e22e">EventInfo</span>
  <span style="color:#a6e22e">Any</span>.<span style="color:#a6e22e">Decoding</span>(<span style="color:#a6e22e">anyData</span>[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>)
 
  <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">ei</span>, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>이제 테스트 코드에서처럼 NewAgent로 Agent 객체를 생성하기 전에 Messenger를 생성해서 전달받을 수 있게 되었습니다. (단, 실제로 Agent를 사용하는 시점에서는 매번 중복 코드가 발생하게 되었습니다. 이 부분은 다음에 다시 개선하기로 합니다.)</p>
<p>이제 GetChangeEventInfo 함수를 구현하기 위해서 MessageQueue에 연결해서 디버깅하기 위한 과정 대신에 테스트 코드가 sample_1 에서 구현되어야 할 내용에 대해서 보장을 해줄 수 있게 되었습니다.</p>
<h2 id="결론">결론</h2>
<p>이제 입력되는 값과 MessageQueue 건너편의 대상으로부터 받기를 원하는 값에 대한 정의만 정확하다면, MessageQueue에 직접 연결되지 않아도 우리는 sample_1 의 기능을 구현할 수 있게 되었습니다.<br>
그리고 코딩 중에 세워졌던 원칙에 어긋나는 경우에 대해서 별도의 문서나 히스토리를 확인하지 않고 작성된 테스트 코드로 확인할 수 있게 되었습니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="December 2, 2017">December 2, 2017</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/go_kvm-with-go/" rel="bookmark">KVM 스터디(with go)</a>
						</h1>
					</header>
					<div class="entry-content">
						<h2 id="준비물">준비물</h2>
<p>노트북(우분투 16.04)</p>
<h2 id="kvm이-뭔가요">KVM이 뭔가요?</h2>
<h3 id="하이퍼바이저">하이퍼바이저?</h3>
<p>위키백과에 나와 있는 정의( <a href="https://ko.wikipedia.org/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%EB%B0%94%EC%9D%B4%EC%A0%80">https://ko.wikipedia.org/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%EB%B0%94%EC%9D%B4%EC%A0%80</a> ) 를 보면 이렇게 나와 있습니다.</p>
<p>&ldquo;다수의 운영 체제를 동시에 실행하기 위한 논리적 플랫폼&rdquo;</p>
<p>여기에 우리가 잘 알고 있는 VmWare, VirtualBox와 같은것도 있고, Xen, KVM 같이 좀 낯선 것들도 있습니다.</p>
<p>내용을 읽다보면, 왠지 중요해 보이는 단어 Type1, Type2, 전가상화, 반가상화 뭐 이런 단어들이 나옵니다.<br>
Type1은 호스트에 하이퍼바이저가 존재하고, Type2는 호스트 OS에 설치된 응용 프로그램 형태로 하이퍼바이저가 존재하는거라고 보면 될 것 같습니다.<br>
그리고 전/반 가상화는 게스트에서 하이퍼바이저에 어떤 방식으로 접근을 하는지에 대한 구분 정도로 보면 어떨까 싶습니다.<br>
전가상화는 게스트OS가 본인이 가상화된 상태라는걸 모르게 모든 하드웨어가 가상화 되어 제공되는 상태이며, 반가상화는 게스트 OS가 가상화되고 있음을 인지하고 특정한 하드웨어를 사용하기 위해서 게스트 OS의 커널의 변경이 필요한 상태입니다.<br>
전가상화와 반가상화에 대해서 가장 이해하기 쉽게 설명된 글을 참고해보면 좋을것 같습니다. ( <a href="https://knowcitrixx.wordpress.com/2014/11/12/hypervisor-full-para-virtualization/">https://knowcitrixx.wordpress.com/2014/11/12/hypervisor-full-para-virtualization/</a> )</p>
<p>이건 공부하면서 이런거 같다라고 정리한 내용이니 100% 믿지는 말기 바랍니다.</p>
<p>이 글에서는 여러가지의 하이퍼바이저들 중에서 KVM(Kernel-based Virtual Machine)을 사용해 보려고 합니다.</p>
<h3 id="어떻게-쓰는거지">어떻게 쓰는거지?</h3>
<h4 id="설치와-vm-생성">설치와 VM 생성</h4>
<p>우리는 QEMU(KVM) 이라는 하이퍼바이저를 설치할 것 입니다.<br>
우선 현재 CPU가 가상화를 지원하는지 확인을 해야합니다.</p>
<pre><code>$ egrep -c ‘(vmx|svm)’ /proc/cpuinfo
</code></pre><p>결과가 1보다 크면 가상화를 지원하는 CPU 입니다.<br>
그럼 KVM 관련 패키지들을 설치해 보겠습니다.<br>
설치하기전에 os관련 업데이트를 하겠습니다.</p>
<pre><code>$ sudo apt-get update
$ sudo apt-get upgrade
</code></pre><p>이제 진짜로 설치&hellip; qemu-kvm을 설치합니다.<br>
qemu-kvm은 qemu/kvm을 관리할 수 있는 기본적인 프로그램들이 설치됩니다.</p>
<pre><code>$ sudo apt install qemu-kvm
</code></pre><p>뭔가 한참을 설치합니다.</p>
<p>설치된 항목들은 확인 하기 위해서 터미널창에서 qemu까지 입력하고 탭을 몇 번 입력해겠습니다.<br>
qemu로 시작하는 command가 몇 개가 보여집니다.<br>
qemu-img(qemu의 디스크 이미지 관리를 위한 명령어),<br>
qemu-io(qemu용 저장 장치를 위한 진단, 조작 프로그램),<br>
qemu-make-debian-root(데비안 루트 이미지를 생성),<br>
qemu-nbd(network block device: 호스트의 블록 디바이스에 연결하여 사용하는 장치, qemu 이미지를 자체적으로 제공하도록 합니다.)<br>
qemu-system-i386, qemu-system-x86_64, qemu-system-x86_64-spice(qemu pc 시스템 에뮬레이터)<br>
그리고 kv까지 입력하고 탭을 몇 번 입력해 보면 kvm으로 시작하는 command가 몇 개 보입니다.<br>
kvm, kvm-ok, kvm-spice</p>
<p>마지막으로 vir까지 입력하고 탭을 몇 번 입력해 보면,<br>
virtfs-proxy-helper<br>
가 보입니다.</p>
<p>이제 KVM이 설치되었는지 확인을 해보겠습니다.</p>
<pre><code>$ lsmod | grep kvm
</code></pre><p>을 하면 &hellip;</p>
<pre><code>kvm_intel    192512    0
kvm        598016    1    kvm_intel
irqbypass    16384        1    kvm
</code></pre><p>위의 결과와 비슷한 화면이 보입니다. 그럼 잘 설치가 되었습니다.</p>
<p>그럼 이제 VM을 생성해보겠습니다.</p>
<p>우선 ubuntu 이미지를 하나 받아 놓습니다.<br>
( <a href="https://help.ubuntu.com/community/Installation/MinimalCD">https://help.ubuntu.com/community/Installation/MinimalCD</a> )</p>
<pre><code>$ wget http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/mini.iso
</code></pre><p>그리고 qemu-img로 디스크를 미리 만들어 놓습니다.</p>
<pre><code>$ qemu-img create ubuntu.qcow2 10G
</code></pre><p>생성한 디스크에 os 설치를 합니다.</p>
<pre><code>$ qemu-system-x86_64 -localtime -net  user -net nic -m 256 -cdrom mini.iso -hda ubuntu.qcow2 -boot d
</code></pre><p><img src="https://docs.google.com/drawings/d/e/2PACX-1vTy6mMJx7hrjFbQVHYBYohYI4Fh3G4kAYDy4XggeWHbZL65NdhBUNNZy3rYSPXWforAfTXm2I4lOKIl/pub?w=603&amp;h=474" alt=""></p>
<p>이렇게 kvm을 이용해서 가상머신상에 ubuntu를 설치해 봤습니다.</p>
<h2 id="go언어는-뭐죠">Go언어는 뭐죠?</h2>
<h3 id="go언어란">Go언어란?</h3>
<p>Go언어에 대한 정의도 위키백과를 참고해 보겠습니다.( <a href="https://ko.wikipedia.org/wiki/Go_(%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%96%B8%EC%96%B4)">https://ko.wikipedia.org/wiki/Go_(%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%96%B8%EC%96%B4)</a> )
구글에서 유명한 아저씨들(로버트 그리즈머, 롭 파이크, 켄 톰슨)이 만들기 시작했습니다.<br>
2009년 11월에 세상에 공개가 되었습니다.</p>
<p>문법은 C랑 비슷하고&hellip;(라고 하지만 Go 코드에 익숙해지고 난 다음에 C코드 보면 정말 헷갈립니다.)</p>
<p>여러가지 편리한 도구들도 제공합니다.<br>
go build<br>
go test<br>
go fmt<br>
go get<br>
go vet<br>
go run<br>
godoc<br>
gorename<br>
go generate</p>
<h3 id="그래서">그래서?</h3>
<h4 id="설치">설치</h4>
<p>설치는 다음과 같이 하면 됩니다.</p>
<ol>
<li>기존에 설치된 버전이 있다면 삭제합니다.
<pre><code>$ rm -r /usr/local/go
</code></pre></li>
<li><a href="http://golang.org/doc/install">http://golang.org/doc/install</a> 에서 다운로드
(또는$ wget –no-check-certificate <a href="https://storage.googleapis.com/golang/go1.7.1.linux-amd64.tar.gz">https://storage.googleapis.com/golang/go1.7.1.linux-amd64.tar.gz</a> 와 같이 원하는 OS 및 버전에 맞는 Go 바이너리를 wget으로 받을 수도 있습니다.)</li>
<li>/usr/local/go에 압축을 풉니다.
<pre><code>$ sudo tar -C /usr/local -xzf gox.x.x.linux-xxx.tar.gz
</code></pre></li>
<li>$HOME/.profile 에 다음을 추가합니다.
<pre><code>PATH=$PATH:/usr/local/go/bin  
</code></pre><pre><code>GOPATH=$HOME/work
</code></pre></li>
<li>.profile을 적용합니다.
<pre><code>$ source ./.profile
</code></pre></li>
<li>설치가 되었으면 제대로 설치되었는지 확인 해봅니다.
<pre><code>$ go version
</code></pre></li>
<li>결과가 다음이랑 비슷하게 나오면 성공한것 입니다.
<pre><code>go version go1.8.1 linux/amd64
</code></pre></li>
</ol>
<h4 id="helloworld">Hello,World</h4>
<p>이제 Hello, World 한번 찍어보겠습니다.</p>
<ol>
<li>에디터(utf-8 편집 가능한걸로)로 다음과 같이,
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"> <span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

 <span style="color:#f92672">import</span> <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">fmt</span><span style="color:#960050;background-color:#1e0010">”</span>

 <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
     <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#960050;background-color:#1e0010">“</span><span style="color:#a6e22e">Hello</span>, <span style="color:#a6e22e">World</span><span style="color:#960050;background-color:#1e0010">”</span>)
 }
</code></pre></div><p>main.go 파일을 하나 만들어서 작성해 보겠습니다.</p>
</li>
<li>이제 저장하고 빌드합니다.
<pre><code>$ go run main.go
$ go build
$ go install
</code></pre><p>빌드하는 방법은 위와 같이 3가지가 있는데, run은 결과물을 굳이 만들지 않고 결과를 바로 확인 할 수 있는거, build는 현재 작업하고 있는 경로에 결과물을 만들어 놓는것 입니다. 그리고 install은 만들어진 결과물을 $GOPATH의 bin 디렉토리 아래에 옮겨주기까지 합니다.</p>
</li>
<li>결과를 확인합니다.</li>
</ol>
<h2 id="libvirt는-또-뭐에요">libvirt는 또 뭐에요?</h2>
<h3 id="뭐하는거">뭐하는거?</h3>
<p>KVM같은 하이퍼바이저를 관리(?)를 하기 위한 라이브러리 정도(?)</p>
<h3 id="이건-또-어떻게-쓰나요">이건 또 어떻게 쓰나요?</h3>
<p>우선 설치를 해보겠습니다.</p>
<pre><code>$ sudo apt install libvirt-bin ubuntu-vm-builder bridge-utils
</code></pre><p>여기에서 libvirt-bin 은 libvirt 관련한 것들(virsh, virt-admin, virt-host-validate, virt-login-shell, virt-pki-validate, virt-xml-validate, virtlockd, virtlogd)이 설치됩니다. 그리고 /var/lib/libvirt라는 디렉토리가 생깁니다.<br>
ubuntu-vm-builder는 깨끗한 테스트환경, 가상 시스템 설치 프로세스를 자동화하거나 하는 VM을 빠르게 만들어 주는게 설치된다고 하는데 뭐가 설치되는지는 아직 잘 모르겠습니다.<br>
그리고 bridge-utils는 브릿지 네트워크를 설정하기 위한 용도의 무언가가 설치된다고 하는데, 설치되는게 없는거 같습니다.</p>
<p>KVM에 대한 사용 권한은 루트 사용자와 현재 사용자만이 갖게 됩니다.<br>
다른 계정을 추가하기 위해서는 다음과 같이 추가합니다.</p>
<pre><code>$ adduser user1 libvirtd
</code></pre><p>이제 virsh 이라는 libvirt를 다루기 위한 쉘 프로그램이 추가 되어 있는걸 확인 할 수 있습니다.<br>
이게 나중에  유용하게 사용이 될 것 입니다.</p>
<p>그리고 이제는 virt-manager라는 GUI기반의 VM 관리 도구를 설치합니다.</p>
<pre><code>$ sudo apt install virt-manager
</code></pre><p>virt-manager를 설치하게 되면 virt-install, virt-viewer, virt-clone, virt-xml, virt-convert 같은걸 추가로 사용할 수 있게 됩니다.</p>
<p>virt-manager를 설치하지 않고 virtinst 를 설치해도 가능할 겁니다.</p>
<p>이제 virt-manager를 사용해서 vm을 생성하고 시작하고 등등의 관리를 GUI 상에서 할 수 있는데, 동일한 작업을 virsh에서 해보기도 하고&hellip;virsh로 해본걸 다시 코드로 작성해 보기도 합니다.</p>
<p>libvirt-go 패키지를 설치합니다.<br>
우선 libvirt-dev 라이브러리의 설치가 필요합니다.</p>
<pre><code>$ sudo apt-get install libvirt-dev
</code></pre><p>그리고</p>
<pre><code>$go get github.com/libvirt/libvirt-go
</code></pre><p>이제 libvirt-go 패키지까지 설치를 마쳤습니다.</p>
<h2 id="그럼-이제-뭘-하면-되죠">그럼 이제 뭘 하면 되죠?</h2>
<h3 id="todolibvirt-go를-사용한-예제들">TODO(libvirt-go를 사용한 예제들)</h3>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="August 1, 2017">August 1, 2017</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/go_core/" rel="bookmark">core파일 만들기</a>
						</h1>
					</header>
					<div class="entry-content">
						<p>Go언어에서도 core dump를 만드는 방법이 있었습니다.</p>
<p>데이브체니님이 정리해 놓은 무려 2015년도의 글 입니다.<br>
<a href="https://dave.cheney.net/2015/11/29/a-whirlwind-tour-of-gos-runtime-environment-variables">https://dave.cheney.net/2015/11/29/a-whirlwind-tour-of-gos-runtime-environment-variables</a></p>
<p>환경변수로 GOTRACEBACK 을 crash로 설정만 해주면 됩니다.</p>
<p>이런것도 모르고 Go언어에서는 dump를 생성할 수 없다고 말하고 다녔습니다&hellip;;</p>
<p>근데 위에 처럼 환경변수 설정하고도 core 파일이 안생긴다면, 다음 블로그의 글을 참고해 보면 좋을것 같습니다.</p>
<p><a href="http://lapan.tistory.com/68">http://lapan.tistory.com/68</a></p>
<p>블로그의 내용처럼 ulimit -a 로 확인 해보니 core file size가 0으로 되어 있습니다.<br>
ulimit -c unlimited 로 해주었습니다.<br>
이제 panic을 발생시켜 보면 core 파일이 잘 만들어져 있는걸 확인 할 수 있습니다.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
				<article class="post">
					<header class="entry-header">
						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="July 27, 2017">July 27, 2017</time>
               </span>
						</div>
						<h1 class="entry-title">
						  <a href="https://shrinklabs.com/post/container_docker/" rel="bookmark">docker 시작하기</a>
						</h1>
					</header>
					<div class="entry-content">
						<h2 id="docker-ce-설치">docker ce 설치</h2>
<ul>
<li>오래된 버전 제거</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get remove docker docker-engine docker.io
</code></pre></div><ul>
<li>패키지 인덱스 업데이트</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get update
</code></pre></div><ul>
<li>apt가 https를 통해서 저장소를 사용할 수 있도록 패키지를 설치</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get install <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    apt-transport-https <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    ca-certificates <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    curl <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    software-properties-common
</code></pre></div><ul>
<li>docker의 공식 GPG 키를 추가</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre></div><ul>
<li>fingerprint를 확인</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-key fingerprint 0EBFCD88
</code></pre></div><ul>
<li>안정화 버전의 저장소를 추가</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo add-apt-repository <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
</span><span style="color:#e6db74">    </span><span style="color:#66d9ef">$(</span>lsb_release -cs<span style="color:#66d9ef">)</span><span style="color:#e6db74"> \
</span><span style="color:#e6db74">    stable&#34;</span>
</code></pre></div><ul>
<li>apt 패키지 인덱스 업데이트</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get update
</code></pre></div><ul>
<li>최근 버전의 docker ce를 설치</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get install docker-ce
</code></pre></div><ul>
<li>특정 버전의 docker ce를 설치하기 위해서 사용 가능한 버전을 나열</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ apt-cache madison docker-ce
</code></pre></div><ul>
<li>docker-ce의 특정 버전 설치(<!-- raw HTML omitted -->은 위에서 나열된 리스트 중에서 선택(2번째 컬럼)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">$ sudo apt-get install docker-ce<span style="color:#f92672">=</span>&lt;VERSION&gt;
</code></pre></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>
        
			</div>
		</div>

		<center class="">
			<ul class="pagination">
        
<ul class="pagination">
  <li class="page-item">
    <a href="/post/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/post/page/2/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/post/">1</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/post/page/2/">2</a>
  </li>
  <li class="page-item active">
    <a class="page-link" href="/post/page/3/">3</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/post/page/4/">4</a>
  </li>
  <li class="page-item disabled">
    <span aria-hidden="true">&nbsp;&hellip;&nbsp;</span>
  </li>
  <li class="page-item">
    <a class="page-link" href="/post/page/6/">6</a>
  </li>
  <li class="page-item">
    <a href="/post/page/4/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/post/page/6/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
  </li>
</ul>


			</ul>
		</center>
	</div>	

</main>

    
    
      <footer id="footer">
	<div class="container">
		<div class="row">
			

			
			<div class="col-md-3 widget">
				<h3 class="widget-title">Follow me</h3>
				<div class="widget-body">
					<p class="follow-me-icons">
            
							
								<a href="https://www.facebook.com/jaehoon" target="_blank"><i class="fab fa-facebook-square fa-1x"></i></a>
							
            
							
								<a href="https://twitter.com/jaehoonn_" target="_blank"><i class="fab fa-twitter-square fa-1x"></i></a>
							
            
							
								<a href="https://github.com/jaehoonn" target="_blank"><i class="fab fa-github fa-1x"></i></a>
							
            
							
								<a href="mailto:jaehoon@shrinklabs.com" target="_blank"><i class="fas fa-envelope-square fa-1x"></i></a>
							
            
					</p>
				</div>
			</div>
			

			

			

		</div> 
	</div>
</footer>

<footer id="underfooter">
	<div class="container">
		<div class="row">

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p></p>
				</div>
			</div>

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p class="text-right">
						Copyright &copy; 2021, <br>
						Design: <a href="http://www.gettemplate.com" rel="designer">Initio by GetTemplate</a> - 
						Powered by: <a href="https://gohugo.io/" rel="poweredby">Hugo</a>
					</p>
				</div>
			</div>

		</div> 
	</div>
</footer>




<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>




<script src="https://shrinklabs.com/js/bundle.min.f4a965ad0a8118e32f8f0f158ff3aadbacf700934c22286a1a5b245105e9006da73a873b001a160db22498909c1df14d1f835dba5ad76f80b32b0234182b2a58.js" integrity="sha512-9KllrQqBGOMvjw8Vj/Oq26z3AJNMIihqGlskUQXpAG2nOoc7ABoWDbIkmJCcHfFNH4NdulrXb4CzKwI0GCsqWA=="></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-4LRCTZDF74', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

    
  </body>
  
</html>