<!DOCTYPE html>
<html lang="en">
  <head>
  	<meta charset="utf-8">
  	<meta name="viewport"    content="width=device-width, initial-scale=1.0">
  	<meta name="description" content="">
  	<meta name="author"      content="map[]">
    
    	<title>build</title>
    
    <script data-ad-client="ca-pub-8444244371421612" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


	<link rel="shortcut icon" href="https://shrinklabs.com/images/favicon.ico">

	
	<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.no-icons.min.css" rel="stylesheet">
	
	
	<script defer src="https://use.fontawesome.com/releases/v5.0.11/js/all.js" integrity="sha384-ImVoB8Er8knetgQakxuBS4G3RSkyD8IZVVQCAnmRJrDwqJFYUE4YOv+DbIofcO9C" crossorigin="anonymous"></script>
	
	
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alice|Open+Sans:400,300,700">
	
	
  
  <link rel="stylesheet" href="https://shrinklabs.com/css/styles.min.16be9015b1d15d94201894c956885e507505d7b2f836db72cf9bb664b89c63ac6f9b7de5b6d4671478edb138a9c227c4c4e6619e22ef55bd586fa93fb6eed058.css" integrity="sha512-Fr6QFbHRXZQgGJTJVoheUHUF17L4Nttyz5u2ZLicY6xvm33lttRnFHjtsTipwifExOZhniLvVb1Yb6k/tu7QWA==">

   
  

  </head>
  
  <body class="home">

    
      <header id="header">
  <div id="head" class="parallax" data-parallax-speed="2" style="background-image:url('https://shrinklabs.com/images/bg_head.jpg');">
    <h1 id="logo" class="text-center">
      <img class='img-circle' src="https://shrinklabs.com/images/logo.png" alt="">
      <span class="title"></span>
      <span class="tagline"><br>
        <a href="mailto:"></a>
      </span>
   </h1>
</div>

<nav class="navbar navbar-default navbar-sticky">
    <div class="container-fluid">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="true">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1">

            <ul class="nav navbar-nav">
            
                
                <li>
                    <a href="/">home</a>
                </li>
                
            
                
                <li>
                    <a href="/post/">blog</a>
                </li>
                
            
            </ul>

        </div> 
        
    </div>
</nav>

</header>
    
 
    
<main id="main">

	<div class="container">

		<div class="row topspace">
			<div class="col-sm-8 col-sm-offset-2">

 				<article class="post">
					<header class="entry-header">
 						<div class="entry-meta">
               <span class="posted-on">
                  <time class="entry-date published" datetime="May 25, 2017">May 25, 2017</time>
               </span>
 						</div>
 						<h1 class="entry-title"><a href="https://shrinklabs.com/post/go_build/" rel="bookmark">build</a></h1>
					</header>
					<div class="entry-content">
						<h2 id="소개">소개</h2>
<p>Go언어로 개발을 하다보면 debug모드 release모드 같이 별도의 빌드 환경을 구성하고 싶을때가 있습니다.<br>
그래서 build 옵션으로 특정한 환경별로 결과를 달리 할 수 있는 방법에 대해서 테스트한 내용을 정리해봅니다.</p>
<h2 id="빌드">빌드</h2>
<p>go 파일들을 빌드하기 위해서는 일반적으로 다음과 같이 합니다.</p>
<pre><code>$ go build
</code></pre><p>Go언어 문서중에 보면 <a href="https://golang.org/pkg/go/build/#hdr-Build_Constraints%5BBuild">https://golang.org/pkg/go/build/#hdr-Build_Constraints[Build</a> Constraints] 에 관한 내용이 있습니다.<br>
이 내용은 build 할 때 조건을 줄 수 있다는 내용이고 방법은 다음과 같이 하면 된다고 합니다.</p>
<p>코드의 상단에 &ldquo;// +build linux&rdquo; 하고 한 칸을 띄우고 &ldquo;package blah&rdquo; 를 시작합니다.</p>
<p>빌드를 하기 위해서는 &ldquo;go build -tags linux&rdquo; 와 같이 하면 &ldquo;// +build linux&quot;가 명시되어 있는 파일들을 빌드합니다.<br>
그리고 &ldquo;// +build !linux&rdquo; 라고 되어 있는 파일의 경우 tags 플래그로 &ldquo;linux&rdquo; 가 들어오면 빌드에서 제외 됩니다.</p>
<p>이렇게 build 조건을 주는 방법을 이용해서 특정한 테스트 또는 디버깅을 위한 코드를 별도로 작성하고 확인 할 수 있을것 같습니다.</p>
<p>그래서 다음과 같은 예제를 작성해 봤습니다.</p>
<p>기본 코드를 다음과 같이 작성을 했습니다.</p>
<p>main.go 파일은 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">Render</span>()
}
</code></pre></div><p>이제 Render() 함수가 존재하는 render.go 파일을 다음과 같이 작성해 봅니다.<br>
Render() 함수는 화면에 &ldquo;release render&quot;라는 내용을 보여주는 기능을 합니다.</p>
<p>render.go 파일은 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Render</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;release render&#34;</span>)
}
</code></pre></div><p>이제 빌드하고 실행을 해보겠습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#66d9ef">go</span> <span style="color:#a6e22e">build</span>
<span style="color:#960050;background-color:#1e0010">$</span> .<span style="color:#f92672">/</span><span style="color:#a6e22e">build_constraint</span>
<span style="color:#a6e22e">release</span> <span style="color:#a6e22e">render</span>
</code></pre></div><p>화면에 &ldquo;release render&quot;라는 내용이 보여지는걸 확인 할 수 있습니다.</p>
<p>이제 Render() 함수의 내용을 debug 용도로 &ldquo;debug render&rdquo; 라고 보여주려고 합니다.</p>
<p>그래서 render_debug.go 파일을 다음과 같이 작성했습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Render</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;debug render&#34;</span>)
}
</code></pre></div><p>이 상태로 그냥 build를 하게 되면 다음과 같은 메세지를 보게 됩니다. +</p>
<pre><code>$ go build
# build_constraint
./render_debug.go:5: Render redeclared in this block
	previous declaration at ./render.go:5
</code></pre><p>Render() 함수가 중복해서 선언되어 있으니 당연한 결과입니다.</p>
<p>이제 위의 코드에 build 옵션을 지정해 보겠습니다ㄴ.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// +build debug
</span><span style="color:#75715e"></span>
<span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Render</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;debug render&#34;</span>)
}
</code></pre></div><p>코드 상단에 &ldquo;// +build debug&rdquo; 를 추가하고 반드시 한 칸을 띄워야 합니다.</p>
<p>이제 build를 실행하면 build가 성공적으로 됩니다.<br>
결과를 확인해 보겠습니다.</p>
<pre><code>$ ./build_constraint
release render
</code></pre><p>화면에 보여지는건 여전히 &ldquo;release render&rdquo; 입니다.<br>
build 옵션을 &ldquo;debug&quot;로 해서 build를 시도해 보겠습니다.</p>
<pre><code>$ go build -tags debug
# build_constraint 
./render_debug.go:7: Render redeclared in this block
	previous declaration at ./render.go:5
</code></pre><p>Render() 함수가 중복되어 선언 되었다고 합니다.<br>
render.go 파일과 render_debug.go 파일에 Render() 함수가 2번 선언된 것으로 확인이 되는것입니다.</p>
<p>그래서 render.go에도 &ldquo;debug&quot;라는 빌드 옵션이 지정될때는 build에서 제외가 되도록 &ldquo;// +build !debug&rdquo; 를 추가합니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// +build !debug
</span><span style="color:#75715e"></span>
<span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Render</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;release render&#34;</span>)
}
</code></pre></div><p>이렇게 추가한 다음 build를 하고 내용을 확인해 봅니다.</p>
<pre><code>$ go build -tags debug
$ ./build_constraint
debug render
</code></pre><p>디버그용 메세지인 &ldquo;debug render&quot;가 화면에 보여집니다.</p>
<p>일반적인 빌드를 시도해 봅니다.</p>
<pre><code>$ go build
$ ./build_constraint
release render
</code></pre><p>이제 아무런 옵션 없이 build를 하고 확인을 해보면 &ldquo;release render&quot;가 화면에 보여지는걸 확인 할 수 있습니다.</p>
<p>위 내용의 예제는 다음의 경로에서 볼 수 있습니다.<br>
<a href="https://github.com/jaehoonn/build_constraint">https://github.com/jaehoonn/build_constraint</a></p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8444244371421612"
     data-ad-slot="6693872766"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

					</div>
				</article>

			</div>
		</div> 

		<div class="row">
			<div class="col-sm-8 col-sm-offset-2">

				<div id="share">
					
				</div>
			</div>
		</div> 
		<div class="clearfix"></div>

		<div class="row">
			<div class="col-sm-8 col-sm-offset-2">

				<div id="comments">
					
				</div>
			</div>
		</div> 
		<div class="clearfix"></div>

	</div>	

</main>

    
    
      <footer id="footer">
	<div class="container">
		<div class="row">
			

			
			<div class="col-md-3 widget">
				<h3 class="widget-title">Follow me</h3>
				<div class="widget-body">
					<p class="follow-me-icons">
            
							
								<a href="https://www.facebook.com/jaehoon" target="_blank"><i class="fab fa-facebook-square fa-1x"></i></a>
							
            
							
								<a href="https://twitter.com/jaehoonn_" target="_blank"><i class="fab fa-twitter-square fa-1x"></i></a>
							
            
							
								<a href="https://github.com/jaehoonn" target="_blank"><i class="fab fa-github fa-1x"></i></a>
							
            
							
								<a href="mailto:jaehoon@shrinklabs.com" target="_blank"><i class="fas fa-envelope-square fa-1x"></i></a>
							
            
					</p>
				</div>
			</div>
			

			

			

		</div> 
	</div>
</footer>

<footer id="underfooter">
	<div class="container">
		<div class="row">

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p></p>
				</div>
			</div>

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p class="text-right">
						Copyright &copy; 2021, <br>
						Design: <a href="http://www.gettemplate.com" rel="designer">Initio by GetTemplate</a> - 
						Powered by: <a href="https://gohugo.io/" rel="poweredby">Hugo</a>
					</p>
				</div>
			</div>

		</div> 
	</div>
</footer>




<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>




<script src="https://shrinklabs.com/js/bundle.min.b4d4f6818b4e26d94fb4399ccecba55248c6c39b666a474da4289f5f9dd5de310f550d6db5ab597255174ef0acf2fd488c3e5d92f0cabc10600c94b70c601f28.js" integrity="sha512-tNT2gYtOJtlPtDmczsulUkjGw5tmakdNpCifX53V3jEPVQ1ttatZclUXTvCs8v1IjD5dkvDKvBBgDJS3DGAfKA=="></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-4LRCTZDF74', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

    
  </body>
  
</html>